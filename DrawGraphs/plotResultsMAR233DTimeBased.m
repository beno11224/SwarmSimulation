function plotResultsMAR233DTimeBased()
%CREATEFIGURE(X1, YMatrix1)
%  X1:  vector of plot x data
%  YMATRIX1:  matrix of plot y data

%  Auto-generated by MATLAB on 08-Apr-2022 11:27:04

close all;

x = 60:60:360;


yBENClump(1,:,:) = [11.1 0 0 0 500 0
13.25 0 0 0 500 0
12.05 0 0 0 500 0
11.75 0 0 23 477 0
11.25 0 0 0 500 0
11.3 0 0 0 500 0
15 0 0 7 146 0
11.95 0 0 0 473 0
12.45 0 0 0 500 0
11.3 0 0 0 500 0];

yBENClump(2,:,:) = [9.9 7 0 3 144 346
10 0 0 1 499 0
12.45 1 0 5 494 0
15 0 0 0 122 4
11 1 0 0 499 0
9.3 0 0 0 500 0
9.6 5 0 16 479 0
12.3 0 4 2 494 0
9 0 0 0 500 0
11.7 0 1 0 498 0];


yBENClump(3,:,:) = [9.475 2 14 0 360 123
11.8 0 0 3 482 0
8.25 0 0 1 493 0
10.325 25 0 7 435 33
10.65 1 0 11 488 0
10.1 3 0 10 480 7
9.25 0 0 2 498 0
12.025 0 17 18 457 0
10.15 11 20 2 426 28
7.7 5 0 4 470 21];

yBENClump(4,:,:) = [8.55 0 0 14 405 81
9.65 21 14 4 369 73
6.625 3 0 23 362 109
7.4 5 12 12 379 92
7.725 1 0 19 390 90
9.9 6 3 7 407 77
8.325 3 1 7 443 46
7.175 1 76 22 297 104
8.925 20 4 26 349 95
6.9 31 3 5 372 89
];

yBENClump(5,:,:) = [9.25 3 1 24 179 163
7.875 45 1 3 306 145
9.95 48 1 3 222 121
9.45 12 0 16 345 122
9.9875 1 0 0 353 137
9.95 21 9 14 216 122
6.05 32 1 21 292 154
8.4875 25 4 39 262 170
9.4375 14 1 12 336 137
9.35 1 2 3 124 188];

yBENClump(6,:,:) = [9.775 45 2 9 322 118
9.225 46 4 6 205 168
5.2375 24 3 7 327 139
4.9625 16 4 18 280 182
9.8875 19 7 11 183 187
5.775 52 1 31 248 168
8 8 15 15 293 169
9.85 30 0 8 273 175
5.4625 30 0 15 318 137
9.3875 5 2 19 252 157];

%---------------------------------------------------------------------

yCombClump{1} = [14.65 0 0 0 495 0
12.8 0 0 0 500 0
13.75 0 0 0 500 0
12.1 0 0 0 500 0
13.75 0 0 0 500 0
11.8 0 0 0 500 0
12.95 0 0 0 403 97
11.8 0 0 2 496 2
15 4 0 0 323 168
14 0 0 0 401 99
14.15 0 0 0 243 257
15 0 1 0 499 0
12.15 0 0 0 500 0
15 8 1 29 237 222
14.6 0 0 0 500 0
13.2 0 0 0 500 0
13.45 1 0 0 499 0
15 6 0 0 29 13
12.75 0 0 0 500 0
14.85 0 0 29 471 0
13.4 0 0 0 500 0
15 0 28 0 0 232
11.3 0 0 0 500 0
14.9 0 0 0 500 0
14.3 0 0 0 500 0
11.7 0 0 0 500 0
13.1 1 0 0 499 0
12.65 0 0 0 500 0
12.2 0 0 0 500 0
14.85 2 0 0 468 0
14.8 21 0 0 479 0
14.15 4 0 1 495 0
15 0 0 0 4 14
13.4 0 0 0 500 0
12.05 0 0 0 500 0
12.5 0 0 9 491 0
12.95 0 0 0 485 0
12.5 0 0 0 498 0
15 63 0 4 432 0
14.45 0 0 0 136 0
11.8 0 0 3 497 0
12.7 0 0 0 500 0
13.15 0 0 0 500 0
15 3 1 0 496 0
14.6 0 1 0 499 0
13.55 0 0 0 500 0
10.8 0 0 0 500 0
11.9 0 0 0 500 0
15 0 0 0 0 0
12.45 0 0 0 500 0
15 26 7 0 467 0
15 0 0 1 418 81
12.9 0 0 0 500 0
14.8 0 0 0 500 0
15 0 0 0 500 0
12.55 0 0 0 500 0
15 274 0 0 225 1
13.95 0 0 4 496 0
15 0 0 24 476 0
14.6 0 0 11 489 0
13.9 0 0 0 500 0
13.9 0 0 0 500 0
12.5 0 0 0 500 0
13.75 0 0 0 500 0
13.7 0 0 0 490 0
15 20 33 0 0 0
12.65 0 0 0 500 0
13.8 0 0 0 500 0
13.1 0 0 0 500 0
13.5 0 0 0 500 0
13.5 0 0 2 498 0
13 0 0 0 78 422
15 202 5 0 136 0
15 0 0 0 480 20
13.8 0 0 0 360 0
12.4 0 0 0 307 0
14.35 0 0 0 500 0
13.25 0 0 33 15 0
12.9 0 0 0 500 0
14.8 0 0 0 447 53
13.95 0 0 0 486 0
13.25 0 0 0 500 0
12.45 0 0 0 500 0
12.35 0 0 0 500 0
13.85 13 0 3 202 253
13.9 0 0 0 244 250
12.55 0 5 0 495 0
14.55 0 0 0 500 0
15 21 0 24 170 14
13.35 0 0 0 500 0
14.1 0 0 0 498 0
12.9 0 0 0 452 48
15 0 0 0 391 3
13.9 0 0 1 499 0
12.9 0 0 1 485 0
12.35 0 0 0 500 0
13.65 0 0 4 496 0
15 0 0 25 139 0
12.55 0 0 0 458 0
13.65 0 0 0 500 0
12.35 0 0 0 500 0];
yCombClump{2} = [14.6 0 0 0 487 13
11.3 0 271 2 227 0
10.5 20 0 0 202 278
14.95 39 0 0 244 217
14.75 399 0 1 76 2
13.35 0 1 20 235 244
13.95 10 0 0 86 389
11.7 0 0 0 496 4
10.45 9 4 0 487 0
9.5 0 0 0 115 385
10.8 0 0 0 500 0
13.7 220 81 0 93 0
15 0 0 0 0 500
15 95 47 0 15 312
9.65 4 0 0 496 0
11.4 0 220 0 280 0
10.15 0 0 0 491 8
14.7 99 0 0 401 0
11.4 44 46 0 85 325
13.9 60 0 4 429 0
13.25 38 178 0 284 0
12.05 18 0 2 479 0
14.15 0 260 0 240 0
9.7 0 0 8 468 24
10.55 283 0 1 216 0
15 19 0 0 0 481
15 16 66 0 141 0
14.45 203 134 0 100 0
9.45 2 0 20 472 5
10.1 72 274 0 154 0
11.15 0 4 22 428 46
15 304 178 0 0 0
15 0 0 0 0 500
11.8 0 13 0 487 0
12.25 16 19 1 464 0
12.45 0 0 0 107 0
11.7 86 0 0 219 195
11.05 139 0 0 361 0
10.9 7 0 2 491 0
11.9 0 0 0 500 0
11.9 265 0 0 235 0
15 0 0 0 0 500
9.65 0 0 0 138 360
13.15 0 0 0 500 0
10.85 0 0 0 500 0
10.05 172 0 0 315 0
15 33 0 0 0 467
8.35 102 307 7 84 0
15 11 54 2 313 113
9.4 0 0 0 500 0
14.25 0 0 0 494 0
12.55 0 0 0 500 0
11.35 320 0 0 180 0
15 0 0 0 0 500
11.25 0 65 0 348 87
11.1 9 3 0 488 0
9.6 37 0 0 436 27
15 31 0 0 453 16
12 12 218 0 270 0
10.35 0 0 0 124 376
9.8 0 0 6 494 0
11.7 0 0 0 499 0
11.55 126 0 0 374 0
15 0 0 0 0 500
15 0 0 0 0 500
11.2 0 0 0 500 0
14.95 8 30 34 179 0
10.7 12 0 0 488 0
10.6 391 0 0 109 0
13.95 0 2 0 10 488
15 0 0 0 500 0
15 0 0 0 0 500
9.7 0 0 0 18 482
10.85 10 0 0 140 350
11.45 114 4 0 379 1
10.15 38 0 0 462 0
10.25 203 0 0 295 2
10.05 47 0 0 431 22
11.225 27 1 7 461 2
12.025 0 0 2 261 0
13.15 27 45 0 48 28
8.375 111 6 16 366 0
11.15 169 0 0 319 9
8.75 164 0 0 198 138
11.8 106 0 0 211 183
10.775 308 0 2 165 10
9.225 133 4 0 354 9
10.25 140 0 0 360 0
12 96 0 17 386 0
8.725 89 1 0 280 130
13.2 0 0 0 500 0
15 71 0 0 429 0
11.6 236 0 1 259 3
9.1 0 0 0 279 221
11.9 0 0 10 411 44
9.15 0 0 0 500 0
9.8 0 0 0 317 183
12.025 12 1 14 473 0
9.8 7 0 0 493 0
12.75 1 0 0 499 0
9.15 4 2 4 384 106
10.075 45 2 0 348 105
9.65 2 0 0 498 0
9.85 12 21 16 439 12
9.6 0 0 0 500 0
9.55 243 0 14 236 7
9.25 3 3 0 439 55
9.9 0 0 0 500 0
14.9 3 0 1 406 0];
yCombClump{3} = [11 2 85 4 109 30
8 2 11 6 169 312
10.95 0 0 1 454 44
12.025 0 4 0 0 496
11.625 58 153 1 215 70
7.775 0 144 6 177 173
8.075 52 77 1 131 239
11.225 5 0 0 202 293
12 2 70 27 188 115
9.15 6 0 10 447 37
8.6 77 217 6 2 198
10.875 3 26 0 163 308
10.45 40 57 0 289 112
11.925 114 39 4 135 88
9.275 6 23 23 303 144
7.8 123 1 0 376 0
10.625 15 16 15 443 11
9 62 168 7 220 43
8.2 9 21 1 287 182
12.025 0 0 0 0 500
11.85 9 31 14 33 248
11.6 6 62 0 183 88
11.1 0 9 7 410 74
9.125 50 22 1 209 218
10.475 32 17 0 20 431
6.775 33 0 0 190 277
12 107 58 8 161 92
9.975 69 69 0 362 0
8.925 212 95 1 169 23
10.95 87 0 0 324 89
8.45 3 2 2 300 193
9.95 0 0 0 71 429
7.825 4 2 0 1 493
11.65 24 127 2 236 5
9.6 93 2 10 395 0
8.95 25 174 0 280 21
12.025 103 54 0 145 83
10.225 78 44 0 120 258
10 88 7 0 248 99
10.675 48 103 0 346 2
8.7 0 0 0 133 367
11.825 1 3 44 382 70
9.025 106 121 4 251 18
8.4 8 6 18 445 14
9.3 146 55 0 154 145
12.025 1 0 0 0 499
11.6 170 115 93 23 60
12 88 134 0 231 8
11.775 2 160 0 128 14
8.625 6 0 5 251 236
7.025 7 2 3 110 373
11.5 0 3 12 47 313
8.675 8 7 0 164 321
11.8 69 5 0 410 12
10.475 15 101 0 56 328
9.225 179 102 1 197 21
8.5 77 18 4 206 188
9.9375 115 1 0 172 180
10.5 2 32 1 148 248
8.575 1 0 22 305 171
7.75 5 12 46 372 65
12.025 173 21 1 291 0
9.5 6 56 0 33 405
8.125 51 14 2 410 23
7.875 218 16 19 233 14
9.9125 3 0 1 326 170
11.95 66 9 1 399 22
8.375 10 0 0 449 40
12.025 10 2 0 448 0
8.35 0 25 0 453 22
9.9 0 0 0 384 116
8.125 265 3 0 232 0
10.25 0 2 0 128 370
9.15 10 43 6 177 264
9.825 4 25 2 21 321
8.725 41 2 14 158 280
7.625 0 2 1 101 396
9.7 33 8 19 99 305
11.45 114 4 0 379 1
8.5 23 28 0 448 1
9.9875 154 5 3 151 101
10.05 47 0 0 431 22
12.025 0 0 2 261 0
8.375 111 6 16 366 0
6.675 96 39 2 191 172
9.6 242 29 5 125 79
11 0 5 0 242 69
9.8875 36 1 6 287 167
9.9875 101 3 11 228 87
12 96 0 17 386 0
8.725 89 1 0 280 130
6.325 203 7 3 190 97
6.2 115 2 2 256 110
8.25 25 0 3 171 301
10.35 29 9 0 252 210
7.9 59 168 0 262 11
6.0375 84 1 2 215 198
7.825 9 46 119 323 3
9.8 0 0 0 317 183
11.225 100 0 0 392 0
9.15 4 2 4 384 106
10.075 45 2 0 348 105
9.05 184 41 0 121 140
9.85 12 21 16 439 12
9.9 5 73 2 185 153
8.6 0 87 2 408 3
9.375 105 1 3 159 165
8.2 115 64 7 314 0
6.0125 37 3 38 186 236
6.2375 6 4 0 387 103
11.8 190 0 2 286 0];
yCombClump{4} = [7.3 37 9 1 231 222
6.75 0 58 7 294 141
10.25 49 1 0 127 323
11.925 4 167 8 210 111
9.3 1 11 4 121 363
12.025 173 46 0 0 85
7.85 45 5 0 184 266
6.725 23 37 1 116 323
9.775 0 0 7 44 395
7.55 0 0 0 175 325
7.45 33 30 32 261 144
10.25 0 11 0 87 393
7.75 4 32 0 60 404
7.45 57 17 0 33 393
7.925 12 101 5 232 150
6.625 116 163 4 8 127
7.55 43 21 15 91 330
10.975 9 150 0 202 126
11.175 28 23 8 115 274
6.875 63 96 0 27 314
12.025 51 149 0 0 299
8.325 26 0 1 133 340
11.1 5 18 49 289 139
8.675 96 82 0 171 151
7.9 214 159 0 3 124
8.375 13 67 0 49 371
6.775 0 22 0 138 340
9.475 2 63 0 170 265
11.475 14 6 0 100 336
7.65 109 205 2 88 96
7.45 17 9 5 140 329
6.675 39 9 0 141 311
8.125 72 205 11 117 95
6.675 17 173 3 173 133
11.075 321 57 0 8 114
7.5 13 82 0 55 350
7.6 36 241 0 165 58
11.875 77 204 0 117 96
11.925 46 94 0 244 114
9.4 152 38 0 126 144
7 31 0 0 67 402
6.5 17 10 13 377 80
7.525 80 22 1 129 268
12.025 114 189 0 75 105
7.175 98 25 3 131 243
7.325 12 1 0 372 115
7 78 59 3 80 280
7.4 1 9 2 191 297
7.825 17 104 1 281 97
7.225 1 9 12 122 356
7.7 21 4 0 191 284
11.825 32 1 0 293 123
11.1 20 35 2 303 138
6.75 10 208 0 153 129
8.025 282 81 0 9 128
9.425 0 46 0 87 367
12.025 235 6 0 0 259
10.725 39 38 0 118 297
7.775 84 111 1 230 74
11.6 35 163 0 135 102
8.275 0 8 0 146 346
7.45 158 130 1 74 137
5.775 156 48 0 2 294
12.025 37 58 0 189 214
6.625 7 21 16 108 348
6.9 43 2 0 150 305
7.85 1 70 3 306 118
7.65 255 47 0 34 131
7.225 23 7 0 333 137
8.275 1 2 0 136 361
8.775 23 0 0 186 291
9.675 55 4 0 86 355
9.825 42 0 0 81 376
7.325 228 2 0 183 87
7.25 75 0 1 75 349
7.825 3 170 8 169 150
7.2 3 138 0 170 187
11.975 42 99 2 229 113
7.425 219 0 0 202 79
10.175 5 75 6 285 129
8.3 0 8 0 343 149
6.875 24 125 0 219 131
11.7 3 0 0 196 292
11.95 169 37 2 188 98
6.35 47 122 1 198 132
7.35 3 6 0 152 339
9.9 42 287 9 62 97];
yCombClump{5} = [8.25 107 16 42 101 210
9.7875 17 30 21 292 129
5.9125 74 11 11 211 192
10 0 0 0 0 339
8.275 35 16 4 207 238
6.5125 83 21 1 218 177
6.0625 5 1 0 174 320
6.0625 122 43 22 141 172
6.4625 33 37 0 196 233
8.425 134 83 2 131 150
8.8375 0 28 1 53 307
9.975 43 0 26 136 250
6.0125 24 37 15 138 286
9.2125 205 106 7 53 127
8.7375 89 28 44 20 238
6.05 13 3 15 132 337
9.925 134 49 9 93 98
6.1375 27 21 4 67 381
6.1125 66 10 18 142 264
6.6 39 32 3 129 297
9.05 0 1 0 150 329
6.2375 21 13 36 278 151
6.2375 129 25 17 182 147
6.7125 145 104 6 60 185
7.5125 72 11 10 124 283
6.4375 64 63 17 190 163
9.4875 23 28 22 130 194
9.9875 117 30 5 178 170
9.725 55 27 13 174 218
7.3875 2 0 12 130 356
6.3 40 5 1 244 208
6.1625 53 48 9 178 212
8.6625 167 101 33 48 151
6.325 123 57 25 115 179
7.7875 6 0 0 114 380
9.75 13 0 25 141 321
6.5375 122 47 7 141 183
8.05 182 89 4 85 140
9.9625 118 50 2 98 153
6.9 27 9 5 131 328
6.775 33 0 0 190 277
9.975 102 0 1 244 137
9.975 90 68 16 45 178
6.4875 4 1 24 152 319
6.0375 192 100 0 14 194
6.2625 58 82 0 58 302
5.6625 97 14 19 172 198
9.775 116 27 0 68 204
6.025 127 41 7 130 195
10 42 17 1 261 170
8 12 9 19 297 163
9.8875 103 17 7 176 197
6.675 70 53 0 45 332
6 113 59 51 97 180
6.1375 20 35 5 207 233
8.775 17 113 5 88 136
9.5125 171 93 18 37 154
6.475 4 75 22 100 299
8.45 15 15 18 169 281
6.8875 142 33 20 133 172
10 72 47 4 115 219
6.625 50 58 33 126 233
6.1625 74 30 31 182 181
9.6125 89 9 0 107 160
6.05 64 1 25 164 246
9.7 129 41 0 177 147
6.4375 69 8 3 258 162
6.25 34 57 72 159 175
6.4125 22 27 10 277 164
9.7 153 6 9 121 164
6.8625 16 14 6 111 353
6.1125 13 24 25 194 244
9.75 38 49 31 27 203
8.8625 19 33 21 117 196
8.725 41 2 14 158 280
9.7 33 8 19 99 305
10 144 60 1 156 132
8.5375 21 2 1 129 202
6.675 96 39 2 191 172
9.8875 36 1 6 287 167
9.875 56 21 0 212 149
6.2 115 2 2 256 110
8.25 25 0 3 171 301
8.375 64 89 22 166 159
6.0375 84 1 2 215 198
7.3 163 126 8 76 126
5.75 75 58 18 205 144
9.375 105 1 3 159 165
6.0125 37 3 38 186 236];
yCombClump{6} = [4.8875 1 99 0 66 334
9.95 71 84 19 66 201
5.3875 15 42 3 158 282
5.5375 29 43 5 110 313
9.275 56 80 0 82 280
7.7625 13 0 3 165 319
6.1875 30 62 6 132 268
8.9 36 5 4 259 190
9.85 44 58 10 172 214
7.075 85 52 5 204 151
9.675 109 37 8 101 196
6.3875 43 71 0 217 169
5.6 83 74 32 137 173
5.3625 11 0 15 131 343
9.9375 128 32 40 59 154
9.75 42 52 8 214 162
8.7 86 49 8 86 187
9.9875 19 23 15 146 296
5.95 146 21 4 158 171
10 113 42 1 167 157
8.275 137 37 32 39 180
6.6375 79 44 1 274 102
6.175 39 71 14 201 175
5.5125 31 15 54 210 187
8.425 191 65 1 70 168
9.925 18 54 0 78 341
4.925 10 0 6 125 323
9.9875 38 75 35 165 182
9.7375 6 24 21 164 188
5.7375 157 79 3 70 191
6.3875 22 63 2 110 303
9.9375 62 34 71 40 224
9.125 60 78 0 79 199
9.6625 35 9 4 136 212
5.325 28 76 18 182 196
8.7625 81 42 12 140 191
8.0375 32 82 39 73 206
9.175 0 9 1 32 352
5.3125 55 38 2 182 223
5.225 118 32 0 174 176
9.525 53 67 6 54 246
5.175 92 37 2 151 218
10 25 59 43 206 165
8.9875 124 154 18 13 175
9.825 18 124 0 47 276
8.775 69 35 0 219 154
5.525 29 29 18 203 220
9.7125 46 39 17 226 166
9.3 168 77 7 50 187
9.8125 9 5 8 289 187
6.025 8 38 8 119 327
5.6875 114 35 35 152 164
9.5875 98 31 11 103 178
6.75 70 46 29 178 177
7.8875 126 73 2 109 186
5.6125 216 90 8 20 166
7.4625 27 5 3 149 316
5.85 106 16 11 139 227
9.025 115 72 7 111 162
9.975 14 0 1 229 156
5.875 79 48 10 187 176
5.975 56 23 0 65 158
8.75 62 63 7 122 210
9.9875 4 0 21 58 349
7.4125 52 48 5 122 264
7.4625 22 108 40 121 201
6.275 21 14 1 219 245
9.7625 40 4 1 295 152
9.8 73 41 7 200 157
8.25 117 156 0 47 180
5.95 32 42 19 216 191
8.1375 25 59 0 88 326
6.0875 13 0 0 169 318
6.2 4 0 60 95 339
7.8125 16 6 4 128 319
9.4875 46 49 2 98 291
9.9625 48 26 1 148 179
6.7 32 3 5 147 313
7.95 86 100 1 108 205
5.525 18 64 16 250 151
6.825 92 4 0 211 192
8.8625 136 7 3 251 101
7.75 198 0 27 128 147
5.3875 51 131 16 141 161
9.7375 149 68 0 151 132
6.525 53 3 5 253 180
5.6625 108 3 2 218 169
5.5375 50 75 61 126 186];

%fgf = figure;
%axes1 = axes('Parent',fgf);
%hold(axes1,'on');
drawData = yCombClump;
for(i = 1:size(drawData,2))
    flowVel = i*60;
    x1 = repmat([flowVel,flowVel,flowVel,flowVel,flowVel],size(drawData{i},1),1);
    y1 = squeeze(repmat(drawData{i}(:,1),1,size(drawData{i},2)-1));
    z1 = squeeze(drawData{i}(:,2:6)./5);
    plotdata = plot3(x1,y1,z1,'.','MarkerSize',10);
    hold on;
   % set(plotdata(1),'Color',"red");

    set(plotdata(1),'Color','blue');
    set(plotdata(2),'Color','red');
    set(plotdata(3),'Color','yellow');
    set(plotdata(4),'Color','magenta');
    set(plotdata(5),'Color','green');
end

    xlabel( "Maximum fluid flow velocity (mm/s)");
    ylabel("Time taken to reach the goal states (s)");
    zlabel("Percentage of particles reaching each goal state");
    xlim([60,360]);
    ylim([0,15]);
   % zlim([0,100]);
    xticks(60:60:360);
    grid("on");
    legend(["Goal 1", "Goal 2", "Goal 3", "Goal 4", "Goal 5"],"Location","northeast");

%yBENClump = yBENClump./5;
%yBENSplit = yBENSplit./5;

%yBENClumpSummed = cumsum(yBENClump,2);
%yBENSplitSummed = cumsum(yBENSplit,2);

%More Experiment Data:
yExperimentClump{1} = [0 0.45454545454545453 0.36363636363636365 487.1818181818182 0.2727272727272727;
12.333333333333334 5 0 364 84.22222222222223;
48.27272727272727 32.09090909090909 14 307.3636363636364 76.0909090909091;
47.142857142857146 139.71428571428572 3.857142857142857 176.57142857142858 129.71428571428572;
73.77777777777777 54.888888888888886 11.555555555555555 145.11111111111111 173.33333333333334;
56.5 64.125 19.5 139.875 205.5];

yExperimentSplit{1} = [0 0 0.25 439.75 7.625;
34.81818181818182 0 0.7272727272727273 459.27272727272725 4.636363636363637;
13.25 103.375 10.375 274 69.875;
39.84615384615385 124 4.384615384615385 221.69230769230768 95.07692307692308;
95.61538461538461 60.69230769230769 18.923076923076923 205.46153846153845 78.84615384615384;
116.08333333333333 98.83333333333333 15 126.58333333333333 85.83333333333333];

yExperimentClump{2} = [0 0.7 3.4 447 2;
50 0 0.3 336.5 104.2;
51.8 3.6 4 360.7 55.9;
65.3 9.5 0.7 178.9 244.6;
60.5 5.7 8.9 191.8 221.1;
68.2 4 4.8 189 230.3];

yExperimentSplit{2} = [3.4 0 6.2 357 69.9;
120.3 0 0.4 335.8 31.7;
132.9 0.9 4.7 330.1 27;
124.6 14.6 1.5 209.4 119.3;
110.1 17 2.5 213.3 120.9;
143.9 8.1 8.7 202.8 109];

yExperimentClump{3} = [0 0.1 0 440.2 9.7;
1.2 0.4 5 411 82.2;
11.7 37.6 9.3 348.1 92.8;
33 82.2 1.7 163.3 213.6;
52.6 35.1 13.1 171.2 204.9;
54.6 39.8 22.4 156.3 186.8];

yExperimentSplit{3} = [13.2 13.7 0.4 448.9 6.5;
13.7 16.6 3.5 406.1 46.3;
27.3 71.9 7.3 328.1 59;
38.9 61.8 18.9 248.5 121.4;
64.9 54.6 38.5 213 96.8;
69.3 77 23.9 210.7 97.4];

yExperimentClump{4} = [0.6 0 0 412.2 11.2;
18.3 0 2.2 338.8 140.4;
33.9 15.6 7.3 256.4 135.1;
35.2 40.8 1.7 164.7 252.9;
56 23.6 6 192.2 217;
41 28.9 8.1 163.8 220];

yExperimentSplit{4} = [0 0.1 0.8 383.6 13.3;
117.3 0 1.5 343.7 35.3;
97.7 9.7 1.7 304 38.5;
68.1 63.4 0.5 242.7 104.7;
106.7 25.3 3.1 251.2 86.9;
122.3 43 6.5 187.3 114.4];

%THIS ONE IS COMBINED
yExperimentClump{5} = [0.975609756097561 0.2926829268292683 2.4390243902439024 427.3414634146341 20.341463414634145;
53.89795918367347 1.836734693877551 2.2857142857142856 345.6530612244898 82.3061224489796;
60.666666666666664 15.137254901960784 7.470588235294118 266.72549019607845 120.92156862745098;
49.44444444444444 54.851851851851855 1.8888888888888888 173.03703703703704 217.88888888888889;
63.06896551724138 27.137931034482758 8.724137931034482 177.44827586206895 204.86206896551724;
55.142857142857146 30.071428571428573 10.178571428571429 165.96428571428572 219.53571428571428];

yExperimentSplit{5} = [36.1875 0.020833333333333332 1.6458333333333333 367.6458333333333 46.916666666666664;
91.33333333333333 4.7254901960784315 0.9607843137254902 308.4313725490196 85.49019607843137;
94.4375 21.958333333333332 5.875 259.3958333333333 95.97916666666667;
74.0909090909091 72.48484848484848 2.3333333333333335 224.33333333333334 105.33333333333333;
103.36363636363636 36.72727272727273 9.151515151515152 221.6969696969697 94.03030303030303;
126.71875 53.03125 10.375 169.375 102];



%Now draw the data:

% Create figure
figure1 = figure;
figure2 = figure;

% Create axes
axes1 = axes('Parent',figure1);
hold(axes1,'on');
axes2 = axes('Parent',figure2);
hold(axes2,'on');

plot1 = plot(axes1,x,yBENClump, '.-','MarkerSize',4,'MarkerFaceColor','#ff3300');
plot2 = plot(axes2,x,yBENSplit, '.-','MarkerSize',4,'MarkerFaceColor','#ff3300');

set(plot1(1),'DisplayName','Goal 1');
set(plot1(2),'DisplayName','Goal 2');
set(plot1(3),'DisplayName','Goal 3');
set(plot1(4),'DisplayName','Goal 4');
set(plot1(5),'DisplayName','Goal 5');
xlabel(axes1,"Maximum Fluid Velocity (mm/s)");
ylabel(axes1, 'Percentage of particles reaching each goal state');
title(axes1,'Percentage of particles reaching each goal state for different fluid velocities starting in a clump formation');
box(axes1,'on');
grid(axes1,'on');
legend(axes1,'show','Location','northeast');

set(plot2(1),'DisplayName','Goal 1');
set(plot2(2),'DisplayName','Goal 2');
set(plot2(3),'DisplayName','Goal 3');
set(plot2(4),'DisplayName','Goal 4');
set(plot2(5),'DisplayName','Goal 5');
xlabel(axes2,"Maximum Fluid Velocity (mm/s)");
ylabel(axes2, 'Percentage of particles reaching each goal state');
title(axes2,'Percentage of particles reaching each goal state for different fluid velocities starting in a split formation');
box(axes2,'on');
grid(axes2,'on');
legend(axes2,'show','Location','northeast');


 for(i = 1:size(yExperimentClump,2))
    % Create figure
    figureClumpNew = figure; 
    figureSplitNew = figure;

    %Create axes
    axesClumpNew = axes('Parent',figureClumpNew);
    hold(axesClumpNew,'on');
    axesSplitNew = axes('Parent',figureSplitNew);
    hold(axesSplitNew,'on');


    if(true)

        %Both bar charts
        barPlotClump = bar(axesClumpNew, x-12.5, yExperimentClump{i}./5,0.4, "stacked");
        barPlotSplit = bar(axesSplitNew, x-12.5, yExperimentSplit{i}./5,0.4, "stacked");
        barPlotClumpB = bar(axesClumpNew, x+12.5, yBENClump,0.4, "stacked");
        barPlotSplitB = bar(axesSplitNew, x+12.5, yBENSplit,0.4, "stacked");
        set(barPlotClumpB(1),'FaceColor','blue');
        set(barPlotClumpB(2),'FaceColor','red');
        set(barPlotClumpB(3),'FaceColor','yellow');
        set(barPlotClumpB(4),'FaceColor','magenta');
        set(barPlotClumpB(5),'FaceColor','green');
        set(barPlotSplitB(1),'FaceColor','blue');
        set(barPlotSplitB(2),'FaceColor','red');
        set(barPlotSplitB(3),'FaceColor','yellow');
        set(barPlotSplitB(4),'FaceColor','magenta');
        set(barPlotSplitB(5),'FaceColor','green');
        hold on;

        set(barPlotClump(1),'DisplayName','Goal 1');
        set(barPlotClump(2),'DisplayName','Goal 2');
        set(barPlotClump(3),'DisplayName','Goal 3');
        set(barPlotClump(4),'DisplayName','Goal 4');
        set(barPlotClump(5),'DisplayName','Goal 5');
        set(barPlotSplit(1),'DisplayName','Goal 1');
        set(barPlotSplit(2),'DisplayName','Goal 2');
        set(barPlotSplit(3),'DisplayName','Goal 3');
        set(barPlotSplit(4),'DisplayName','Goal 4');
        set(barPlotSplit(5),'DisplayName','Goal 5');
        set(barPlotClumpB(1),'DisplayName','Goal 1 (Ex)');
        set(barPlotClumpB(2),'DisplayName','Goal 2 (Ex)');
        set(barPlotClumpB(3),'DisplayName','Goal 3 (Ex)');
        set(barPlotClumpB(4),'DisplayName','Goal 4 (Ex)');
        set(barPlotClumpB(5),'DisplayName','Goal 5 (Ex)');
        set(barPlotSplitB(1),'DisplayName','Goal 1 (Ex)');
        set(barPlotSplitB(2),'DisplayName','Goal 2 (Ex)');
        set(barPlotSplitB(3),'DisplayName','Goal 3 (Ex)');
        set(barPlotSplitB(4),'DisplayName','Goal 4 (Ex)');
        set(barPlotSplitB(5),'DisplayName','Goal 5 (Ex)');

        xlabel(axesClumpNew,"Maximum Fluid Velocity (mm/s)");
        ylabel(axesClumpNew, 'Percentage of particles reaching each goal state');
        title(axesClumpNew,'Percentage of particles reaching each goal state for different fluid velocities starting in a clump formation');
        box(axesClumpNew,'on');
        grid(axesClumpNew,'on');
        legend(axesClumpNew,'show','Location','southwest');

        xlabel(axesSplitNew,"Maximum Fluid Velocity (mm/s)");
        ylabel(axesSplitNew, 'Percentage of particles reaching each goal state');
        title(axesSplitNew,'Percentage of particles reaching each goal state for different fluid velocities starting in a split formation');
        box(axesSplitNew,'on');
        grid(axesSplitNew,'on');
        legend(axesSplitNew,'show','Location','southwest');
    else
        if(true)
            barPlotClump = bar(axesClumpNew, x, yExperimentClump{i}./5, "stacked");
            barPlotSplit = bar(axesSplitNew, x, yExperimentSplit{i}./5, "stacked");
            plotBenClumpCumulative = plot(axesClumpNew,x,yBENClumpSummed, '.-','MarkerSize',4,'MarkerFaceColor','#ff3300');
            plotBenSplitCumulative = plot(axesSplitNew,x,yBENSplitSummed, '.-','MarkerSize',4,'MarkerFaceColor','#ff3300');
        else
        %plot
        plotNewClump = plot(axesClumpNew,x,yExperimentClump{i}./5, '.-','MarkerSize',4,'MarkerFaceColor','green');
        xlabel(axesClumpNew,"Maximum Fluid Velocity (mm/s)");
        ylabel(axesClumpNew, 'Percentage of total particles reaching each goal state');
        ylim(axesClumpNew,[0,100]);
        title(axesClumpNew,'Percentage of total particles reaching each goal state for different fluid velocities with user control starting in clump formation');
        box(axesClumpNew,'on');
        grid(axesClumpNew,'on');
        legend(axesClumpNew,["Goal 1", "Goal 2", "Goal 3", "Goal 4", "Goal 5"],'Location','northwest');
    
        plotNewSplit = plot(axesSplitNew,x,yExperimentSplit{i}./5, '.-','MarkerSize',4,'MarkerFaceColor','green');
        xlabel(axesSplitNew,"Maximum Fluid Velocity (mm/s)");
        ylabel(axesSplitNew, 'Percentage of total particles reaching each goal state');
        ylim(axesSplitNew,[0,100]);
        title(axesSplitNew,'Percentage of total particles reaching each goal state for different fluid velocities with user control starting in split formation');
        box(axesSplitNew,'on');
        grid(axesSplitNew,'on');
        legend(axesSplitNew,["Goal 1", "Goal 2", "Goal 3", "Goal 4", "Goal 5"],'Location','northwest');
        end
    end
 end
end